# Админ API

## Методы компоненты и их описание

```1c
ПолучитьСписокТопиков(Брокер)
```

**Брокер** - Строка. Брокер, для которого необходимо получить список топиков.

Метод возвращает строку JSON.
Структура:
+ topics - Массив информации о топиках
+ topic - Топик брокера
+ partitions - Количество партиций в топике

---

```1c
ПолучитьМетаданныеТопика(Брокер, ИмяТопика, Таймаут = 5000)
```

**Брокер** - Строка. Адрес брокера (например, "localhost:9092").

**ИмяТопика** - Строка. Имя топика, для которого необходимо получить метаданные.

**Таймаут** - Число. Таймаут ожидания ответа в миллисекундах. По умолчанию 5000.

Метод возвращает строку JSON с детальной информацией о топике.

Структура:
+ brokers - Массив информации о брокерах кластера
  + id - Идентификатор брокера
  + host - Хост брокера
  + port - Порт брокера
+ topic - Имя топика
+ partitions_count - Количество партиций в топике
+ partitions - Массив информации о партициях
  + id - Номер партиции
  + leader - ID брокера-лидера партиции
  + replicas - Массив ID брокеров, содержащих реплики
  + isrs - Массив ID брокеров в In-Sync Replicas (синхронизированные реплики)
  + error - Ошибка (если есть)
+ error - Ошибка топика (если есть)

Пример использования:

```1c
Компонента = Новый("AddIn.SimpleKafka1C.SimpleKafka1C");

// Опционально: установка параметров подключения
Компонента.УстановитьПараметр("security.protocol", "SASL_SSL");
Компонента.УстановитьПараметр("sasl.mechanisms", "PLAIN");
Компонента.УстановитьПараметр("sasl.username", "user");
Компонента.УстановитьПараметр("sasl.password", "password");

// Получение метаданных топика
РезультатJSON = Компонента.ПолучитьМетаданныеТопика("localhost:9092", "my-topic");

Если ПустаяСтрока(РезультатJSON) Тогда
    Сообщить("Ошибка: " + Компонента.ПолучитьСообщениеОбОшибке());
КонецЕсли;
```

Пример ответа:

```json
{
    "brokers": [
        {
            "id": "0",
            "host": "kafka-broker-1",
            "port": "9092"
        },
        {
            "id": "1",
            "host": "kafka-broker-2",
            "port": "9092"
        }
    ],
    "topic": "my-topic",
    "partitions_count": "3",
    "partitions": [
        {
            "id": "0",
            "leader": "0",
            "replicas": ["0", "1"],
            "isrs": ["0", "1"]
        },
        {
            "id": "1",
            "leader": "1",
            "replicas": ["1", "0"],
            "isrs": ["1", "0"]
        },
        {
            "id": "2",
            "leader": "0",
            "replicas": ["0", "1"],
            "isrs": ["0", "1"]
        }
    ]
}
```

---

```1c
СоздатьТопик(Брокер, ИмяТопика, КоличествоПартиций, ФакторРепликации)
```

**Брокер** - Строка. Адрес брокера (например, "localhost:9092").

**ИмяТопика** - Строка. Имя создаваемого топика.

**КоличествоПартиций** - Число. Количество партиций для топика.

**ФакторРепликации** - Число. Фактор репликации (количество реплик каждой партиции).

Метод возвращает `Истина` при успешном создании топика, `Ложь` - при ошибке.
В случае ошибки текст можно получить методом `ПолучитьСообщениеОбОшибке()`.

Пример использования:

```1c
Компонента = Новый("AddIn.SimpleKafka1C.SimpleKafka1C");

// Опционально: установка параметров подключения
Компонента.УстановитьПараметр("security.protocol", "SASL_SSL");
Компонента.УстановитьПараметр("sasl.mechanisms", "PLAIN");
Компонента.УстановитьПараметр("sasl.username", "user");
Компонента.УстановитьПараметр("sasl.password", "password");

// Создание топика с 3 партициями и фактором репликации 2
Если Компонента.СоздатьТопик("localhost:9092", "new-topic", 3, 2) Тогда
    Сообщить("Топик успешно создан");
Иначе
    Сообщить("Ошибка создания топика: " + Компонента.ПолучитьСообщениеОбОшибке());
КонецЕсли;
```

> **Примечание:** Для создания топиков требуются соответствующие права доступа на кластере Kafka.

---

```1c
УдалитьТопик(Брокер, ИмяТопика)
```

**Брокер** - Строка. Адрес брокера (например, "localhost:9092").

**ИмяТопика** - Строка. Имя удаляемого топика.

Метод возвращает `Истина` при успешном удалении топика, `Ложь` - при ошибке.
В случае ошибки текст можно получить методом `ПолучитьСообщениеОбОшибке()`.

Пример использования:

```1c
Компонента = Новый("AddIn.SimpleKafka1C.SimpleKafka1C");

// Опционально: установка параметров подключения
Компонента.УстановитьПараметр("security.protocol", "SASL_SSL");
Компонента.УстановитьПараметр("sasl.mechanisms", "PLAIN");
Компонента.УстановитьПараметр("sasl.username", "user");
Компонента.УстановитьПараметр("sasl.password", "password");

// Удаление топика
Если Компонента.УдалитьТопик("localhost:9092", "old-topic") Тогда
    Сообщить("Топик успешно удален");
Иначе
    Сообщить("Ошибка удаления топика: " + Компонента.ПолучитьСообщениеОбОшибке());
КонецЕсли;
```

> **Внимание:** Удаление топика является необратимой операцией. Все данные в топике будут безвозвратно удалены.
> Для удаления топиков требуются соответствующие права доступа на кластере Kafka, а также параметр `delete.topic.enable=true` в конфигурации брокера.
